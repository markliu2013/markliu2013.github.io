// Modern News Ticker v2.0 | Copyright (c) CreativeTier | contact@CreativeTier.com
!function(a){"use strict";var b={effect:"scroll",linksEnabled:!0,pauseOnHover:!0,autoplay:!0,feedType:"none",feedCount:5,linkTarget:"_blank",refresh:"10:00"},c={scroll:{scrollType:"continuous",scrollStart:"inside",scrollInterval:20,transitionTime:500},fade:{displayTime:4e3,transitionTime:300},type:{typeInterval:10,displayTime:4e3,transitionTime:300},slide:{slideDistance:100,displayTime:4e3,transitionTime:350}},d={rss:{feedUrl:"",loadType:"direct",loadProcess:"YQL",forceNoCache:!1,rssLoadFile:"modern-ticker/php/load-rss.php"},json:{feedUrl:"",forceNoCache:!1,jsonLoadFile:"modern-ticker/php/load-json.php"},twitter:{twitterName:"",twitterLoadFile:"modern-ticker/php/load-twitter.php"}},e={noRssLoadFile:"RSS load file not found.",noJsonLoadFile:"JSON load file not found.",noTwitterLoadFile:"Twitter load file not found.",noFile:"File not found.",empty:"Empty response.",default:"See the browser console."},f={init:function(f){var h,g={};return f.feedType&&(f.feedType=f.feedType.toLowerCase()),"rss-atom"===f.feedType&&(f.feedType="rss"),f.twitterLoadingFile&&(f.twitterLoadFile=f.twitterLoadingFile),f.processService&&(f.loadProcess=f.processService),h=f.effect?f.effect:b.effect,a.extend(g,c[h]),h=f.feedType?f.feedType:b.feedType,a.extend(g,d[h]),a.extend(g,b,f),this.each(function(){function z(){var a=o.width();p.length&&(a-=p.outerWidth(!0)),t.length&&(a-=t.outerWidth(!0)),a=Math.round(a),q.css("width",a),c=a}function A(){b=0,r.children().each(function(){b+=a(this).outerWidth(!0)+1}),r.css("width",b)}function B(){if(O(),r.addClass("mt-hide"),q.addClass("mt-preloader"),r.children().remove(),r.css("margin-left",0),s.css("opacity","1").removeClass("mt-hide"),r.append(s),"rss"===g.feedType||"json"===g.feedType){var b=g.feedUrl;g.forceNoCache&&(-1===b.indexOf("?")?b+="?":b+="&",b+=Math.random().toString())}switch(g.feedType){case"rss":"process"===g.loadType?("rss2json"!==g.loadProcess&&(b=encodeURIComponent(b)),"self"===g.loadProcess?a.ajax({url:g.rssLoadFile,type:"GET",data:{url:b},dataType:"json",success:function(a,b,c){a?(C(a.channel.item),F()):E(e.empty)},error:function(a,b,c){D(c,e.noRssLoadFile)}}):"rss2json"===g.loadProcess?a.ajax({url:"http://api.rss2json.com/v1/api.json",type:"GET",data:{rss_url:b},dataType:"json",success:function(a,b,c){"ok"===a.status?(C(a.items),F()):E(a.message,"rss2json")},error:function(a,b,c){D(c,e.noFile)}}):a.ajax({url:"https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20rss%20where%20url%3D'"+b+"'&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=",type:"GET",dataType:"json",success:function(a,b,c){a.query.results?(C(a.query.results.item),F()):a.query.diagnostics.url&&E(a.query.diagnostics.url["http-status-message"],"YQL")},error:function(a,b,c){D(c,e.noFile)}})):a.ajax({url:b,type:"GET",dataType:"xml",success:function(b,c,d){b?(C(a(b).find("item"),"xml"),F()):E(e.empty)},error:function(a,b,c){D(c,e.noFile)}});break;case"json":"process"===g.loadType?a.ajax({url:g.jsonLoadFile,type:"GET",data:{url:b},dataType:"json",success:function(a,b,c){a?(C(a.items),F()):E(e.empty)},error:function(a,b,c){D(c,e.noJsonLoadFile)}}):a.ajax({url:g.feedUrl,type:"GET",dataType:"json",success:function(a,b,c){"ok"===a.status?(C(a.items),F()):E(a.message)},error:function(a,b,c){D(c,e.noFile)}});break;case"twitter":a.ajax({url:g.twitterLoadFile,type:"GET",data:{name:g.twitterName,count:g.feedCount},success:function(b,c,d){b?(b=a.parseJSON(b),b.errors?E(b.errors[0].message,"Twitter"):(C(b,"twitter"),F())):E(e.empty)},error:function(a,b,c){D(c,e.noTwitterLoadFile)}})}}function C(a,b){var c,d,e;if(d=0===g.feedCount||a.length<=g.feedCount?a.length:g.feedCount,"xml"===b)for(c=0;c<d;c++)e="<li>",g.linksEnabled&&(e+='<a href="'+a.eq(c).children("link").text()+'" target="'+g.linkTarget+'">'),e+=a.eq(c).children("title").text(),g.linksEnabled&&(e+="</a>"),e+="</li>",r.append(e);else if("twitter"===b)for(c=0;c<d;c++)e="<li>",g.linksEnabled&&(e+='<a href="http://twitter.com/#!/'+a[c].user.id_str+"/status/"+a[c].id_str+'" target="'+g.linkTarget+'">'),e+=a[c].text,g.linksEnabled&&(e+="</a>"),e+="</li>",r.append(e);else for(c=0;c<d;c++)e="<li>",g.linksEnabled&&(e+='<a href="'+a[c].link+'" target="'+g.linkTarget+'">'),e+=a[c].title,g.linksEnabled&&(e+="</a>"),e+="</li>",r.append(e)}function D(a,b){E("Not Found"===a?b:a)}function E(a,b){q.removeClass("mt-preloader");var c="";c=b||"Error",c+=": ",a||(a=e.default);var d='<p class="mt-error">'+c+a+"</p>";q.append(d)}function F(){q.removeClass("mt-preloader"),r.removeClass("mt-hide"),H()}function G(){"rss"!==g.feedType&&"json"!==g.feedType&&"twitter"!==g.feedType||(clearTimeout(m),l=!1,B())}function H(){A(),"scroll"!=g.effect&&r.children("li:not(:first)").addClass("mt-hide"),k?(k=!1,g.autoplay&&(M(),t.length&&S())):P(),K("first"),g.refresh&&(m=setTimeout(G,I(g.refresh))),l=!0}function I(a){var b;if("number"==typeof a)b=a;else{var c=a.split(":");c.reverse(),b=parseFloat(c[0]),c[1]&&(b+=60*parseFloat(c[1])),c[2]&&(b+=3600*parseFloat(c[2]))}return 1e3*b}function J(a){l&&K(a.data.type)}function K(d){if(!i){var e,f,h;switch(i=!0,O(),d){case"first":switch(g.effect){case"scroll":"outside"==g.scrollStart&&r.css("margin-left",c),P();break;case"fade":r.children(":first").css({opacity:0}).animate({opacity:1},g.transitionTime,function(){P()});break;case"type":Q(r.children(":first").css({opacity:0}).animate({opacity:1},g.transitionTime).children("a"));break;case"slide":r.children(":first").css({opacity:0,"margin-left":g.slideDistance}).animate({opacity:1,"margin-left":0},g.transitionTime,function(){P()})}i=!1;break;case"prev":switch(g.effect){case"scroll":"discontinuous"==g.scrollType?(e=L(),f=x.length-1,-1===e||0===e?r.animate({"margin-left":c},g.transitionTime,function(){r.css("margin-left",-b),r.animate({"margin-left":-x[f]},g.transitionTime,function(){i=!1})}):(h=-x[e-1],r.animate({"margin-left":h},g.transitionTime,function(){i=!1}))):(r.css({"margin-left":-a(r.children(":last")).outerWidth()}).children(":last").prependTo(r),r.animate({"margin-left":0},g.transitionTime,function(){i=!1})),t.length&&u.mouseleave(function(){P()});break;case"fade":r.children(":first").animate({opacity:0},g.transitionTime,function(){a(this).addClass("mt-hide"),r.children(":last").prependTo(r).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},g.transitionTime,function(){P()}),i=!1});break;case"type":r.children(":first").animate({opacity:0},g.transitionTime,function(){a(this).addClass("mt-hide"),Q(r.children(":last").prependTo(r).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},g.transitionTime).children("a")),i=!1});break;case"slide":r.children(":first").animate({opacity:0},g.transitionTime,function(){a(this).addClass("mt-hide"),r.children(":last").prependTo(r).removeClass("mt-hide").css({opacity:0,"margin-left":g.slideDistance}).animate({opacity:1,"margin-left":0},g.transitionTime,function(){P()}),i=!1})}break;case"next":switch(g.effect){case"scroll":"discontinuous"==g.scrollType?(e=L(),f=x.length-1,e==f?r.animate({"margin-left":-b},g.transitionTime,function(){r.css("margin-left",c),r.animate({"margin-left":0},g.transitionTime,function(){i=!1})}):(h=-1==e?0:-x[e+1],r.animate({"margin-left":h},g.transitionTime,function(){i=!1}))):r.animate({"margin-left":-a(r.children(":first")).outerWidth()},g.transitionTime,function(){r.css("margin-left",0).children(":first").appendTo(r),i=!1}),t.length&&v.mouseleave(function(){P()});break;case"fade":r.children(":first").animate({opacity:0},g.transitionTime,function(){a(this).addClass("mt-hide").appendTo(r),r.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},g.transitionTime,function(){P()}),i=!1});break;case"type":r.children(":first").animate({opacity:0},g.transitionTime,function(){a(this).addClass("mt-hide").appendTo(r),Q(r.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},g.transitionTime).children("a")),i=!1});break;case"slide":r.children(":first").animate({opacity:0},g.transitionTime,function(){a(this).addClass("mt-hide").appendTo(r),r.children(":first").removeClass("mt-hide").css({opacity:0,"margin-left":g.slideDistance}).animate({opacity:1,"margin-left":0},g.transitionTime,function(){P()}),i=!1})}}}}function L(){var a=parseFloat(r.css("margin-left")),b=x.length;if(a>0)return-1;a=Math.abs(a);for(var c=0;c<b-1;c++)if(a>=x[c]&&a<x[c+1])return c;return b-1}function M(){f=!0,d="scroll"==g.effect?setInterval(function(){if(!i){var d=parseFloat(r.css("margin-left"));r.css("margin-left",d-1),"discontinuous"==g.scrollType?d<0&&Math.abs(d)>b&&r.css("margin-left",c):d<0&&Math.abs(d)>a(r.children("li")[0]).outerWidth()&&r.css("margin-left",0).children(":first").appendTo(r)}},g.scrollInterval):setInterval(function(){K("next")},g.displayTime)}function N(){f=!1,clearInterval(d)}function O(){f&&(h=!0,N())}function P(){h&&!j&&(M(),h=!1)}function Q(a){R(a);var b=a.html(),c=b.split(""),d="_",e=0;a.html(d);var f=setInterval(function(){for(var g,b=!0,h="",i=!1,j=0;b;)g=c[e++],h+=g,"<"===g&&(i=!0),">"===g&&(i=!1),i||">"===g||j++,(j||e===c.length)&&(b=!1);d=d.split("_")[0]+h,e!==c.length&&(d+="_"),a.html(d),e===c.length&&(clearInterval(f),P())},g.typeInterval);a.data("mt-type",{typing:!0,content:b,interval:f})}function R(a){var b=a.data("mt-type");b&&b.typing&&(clearInterval(b.interval),a.html(b.content),a.data("mt-type").typing=!1)}function S(){w.addClass("mt-pause")}function T(){w.removeClass("mt-pause")}function U(){return!1}var b,c,d,m,f=!1,h=!1,i=!1,j=!1,k=!0,l=!1,n=a(this),o=n.children(".mt-body"),p=o.children(".mt-label"),q=o.children(".mt-news"),r=q.children("ul"),s=r.children("li"),t=o.children(".mt-controls"),u=t.children(".mt-prev"),v=t.children(".mt-next"),w=t.children(".mt-play");if("scroll"==g.effect&&n.addClass("mt-scroll"),p.length&&q.css("left",Math.round(p.outerWidth(!0))),z(),q.css("height",Math.round(n.height()-2*parseInt(o.css("margin")))),a(window).resize(z),"discontinuous"==g.scrollType){var x=[],y=0;r.children().each(function(){x.push(y),y+=a(this).outerWidth()})}g.linksEnabled||r.find("a").removeAttr("href target"),g.pauseOnHover&&q.hover(function(){l&&(O(),j=!0)},function(){l&&(j=!1,P())}),t.length&&(u.mousedown(U).bind("click",{type:"prev"},J),v.mousedown(U).bind("click",{type:"next"},J),w.mousedown(U).click(function(){l&&(f?(N(),T()):(M(),S()))})),"rss"===g.feedType||"json"===g.feedType||"twitter"===g.feedType?B():H(),n.data("pause",O),n.data("resume",P),n.data("refresh",G)})},pause:function(){return this.each(function(){a(this).data("pause")()})},resume:function(){return this.each(function(){a(this).data("resume")()})},refresh:function(){return this.each(function(){a(this).data("refresh")()})}};a.fn.modernTicker=function(b){return f[b]?f[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.modernTicker"):f.init.apply(this,arguments)}}(jQuery);